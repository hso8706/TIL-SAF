# 23.03.21

### servlet 복습
- @WebServlet
- HttpServletRequest, HttpServletResponse
- response.setContentType()
- extends HttpServlet
- PrintWriter
- JDBC 연결 => 사용법 정도는 다시 정리해두기

### JSP
- HTML 태그와 자바 코드를 혼합해서 웹 페이지를 작성할 수 있도록 하는 기술
- JSP 페이지는 서블릿 자바 코드로 변화되어서 실행됨
- html 코드에 java 코드를 넣는 형식. html 코드가 상대적으로 더 많기 때문에
- 장점
  - 웹 페이지 작성이 servlet에 비해 쉬움
  - 비즈니스 로직과 프레젠테이션(화면 디자인)의 분리가 가능함 => JSP 주 목적
- 단점
  - 디버깅이 어려움

### JSP 페이지 처리 과정
1. 클라이언트 요청(*.jsp)
2. *.jsp에 대한 클래스 파일이 있는지 확인
   1. 있으면 3으로 진행
   2. 없으면 서블릿으로 변환(tomcat이 작업) 후 컴파일하고, 이를 메모리에 로드하고 4번으로 진행
3. 메모리 로드가 되어있는지 확인; 안 되어있으면 메모리 로드
4. 클라이언트 요청 처리

### HTML 주석과 JSP 주석
- JSP 파일에서는 HTML 코드를 쓰지만 주석은 다른 주석을 사용
- `<%-- 주석 내용 --%>`
- .jsp 파일에서 .java 파일로 변환될 때 html 주석을 쓰면 주석이 사라지지 않고 남음. jsp 주석을 사용해야 파일이 변환될 때 코드로 넘어가지 않는다.
- 개발자 모드에서 source에 남아있는 것을 확인할 수 있음.

### JSP 페이지 구성 요소
- Fixed template data : html 태그를 의미함(html 문서)
- Element : jsp 문법들
  - Directive Element(지시어 요소)
  - Scripting Element(스크립팅 요소)
  - Action Element(액션 요소, jsp 태그)

### JSP에 등장하는 태그
- html tag
- jsp tag
- jstl tag

### Directive Element(지시어 요소)
- 웹 컨테이너에 특정한 정보를 전달하는 역할
- `<%@ direcitve { 지시어 속성 } %>`
- 지시어는 .jsp를 .java(servlet)으로 변환시켜주는 Tomcat(웹 컨테이너)에게 정보를 주는 역할을 함
- directive 종류 : `page`, `include`, `taglib`
- 
### page 지시어
- jsp 페이지와 관련된 속성(정보)을 정의하고 이 속성(정보)을 웹 컨테이너에게 전달.
- 주로 `contentType`, `import(자바 라이브러리 import)`, `info(자바 코드로 변환되면 주석이 됨)` 속성이 사용됨.
- `import` 속성 외에는 두 번 이상 사용되면 에러가 발생함.
- errorpage, isErrorpage : errorpage인 경우 특수 작업을 함

### include 지시어
- 외부 데이터(html 문서, jsp 페이지 등)를 가져오는 지시어
- include 지시어와 비슷한 역할을 하는 애가 있음. 나중에 비교할 것
  - 지시어(include) 사용; 정적인 include
    - : 복사 붙여넣기 방식, 웹 컨테이너가 java 파일로 변환할 때 include하는 파일을 그대로 복사해서 붙여넣음.
    - : include 되는 내용이 바뀌면 바뀐 파일을 tomcat이 다시 복사해서 다시 파일을 변환해야함. 비효율적임
    - : include를 사용하는 경우는 데이터 변화가 거의 없을 것으로 예정된 외부 데이터를 가져올 때 사용함
  - action element(jsp tag) 사용; 동적인 include
    - : `<jsp: include page = "*.jsp">`
    - : 함수 호출 개념.
    - : 해당 파일을 실행시키고 결과 내용을 가져오는 개념
    - : include 하는 데이터가 자주 바뀌는 경우에 사용

### Scripting Element(스크립팅 요소)
- 구분
  - 선언(declaration)
  - 식(expression)
  - 스크립트렛(scriptlet)
  - 식 언어(expression language)
- 1. 선언(declaration)
  - jsp의 멤버필드나 메소드 선언 시 사용
  - `<%! {선언 내용} %>`
  - tomcat이 문서를 변환할 때 선언부는 따로 변경 없이 그대로 가져감. 때문에 jsp에는 try-catch는 필요없지만, 선언부에는 try-catch도 필요함.
- 2. 식(expression)
  - 변수 값, 계산 결과, 함수 호출 결과를 직접 출력
  - 문장 끝에 세미콜론(;)을 붙이지 않음
  - `<%= {변수, 계산식 혹은 함수} %>
- 3. 스크립트렛(scriptlet)
  - 자바 코드를 기술하는 영역
  - 주된 요소로 안쓰는게 좋음. 명확한 목적을 지닌 애들을 우선하자.
  - `<% {자바 코드} %>`
- 4. 식 언어(expression language)

### JSP 디폴트 객체
- 스크립팅 원소(스크립트렛, 식, 식 언어)에서 선언이나 생성하지 않고 바로 사용할 수 있는 객체
- 자료 표 확인
- JspWriter : PrintWriter + Buffer 기능도 추가되어있음.
- exception : `isErrorPage = true`여야지 사용 가능한 객체, false인 경우에는 나머지 8개 내장 객체만 사용 가능

### Action Element(액션 요소, jsp 태그)
- JSP Action
  - jsp 에서 만들어놓은 태그들이라서 `jsp tag` 라고도 함
  - 반드시 접두어 `jsp:`를 붙여야함. 그렇지 않으면 html 태그지롱
- JSP tag 종류
  - jsp:useBean
  - jsp:setProperty
  - jsp:getProperty
  - jsp:param
  - jsp:plugin
  - jsp:forward => 별표, MVC에도 사용될 예정
  - jsp:include => 별표
- JSP 사용자 정의 태그
  - 필요에 따라 태그를 만들 수 있도록 JSP에서 제공하는 기능
  - html 태그명과 중복을 막기 위해 사용자 정의 태그만의 접두어를 만들어 붙임.
- **jsp:forward**
  - 형태1: `<jsp:forward page = 'relativeURLspec"/>`
  - 형태2: `<jsp:forward page = 'urlSpec"> {<jsp:para .../>} </jsp:forward>`
  - 형태2는 파라미터를 다음 페이지로 들고가야할 경우에 사용
  - forward 태그를 사용하는 jsp파일에서는 출력해봤자 의미도 없고, 뜨지도 않음.

### request 객체의 공유
- forward
  - forward 태그로 연결된 jsp 파일들은 같은 request 객체(요청 정보들을 공유함)
  - 같은 요청 정보를 가지고 다른 페이지를 오픈
- redirect
  - redirct 메서드를 활용하면 다른 request 객체를 사용한다.
  - 요청을 받은 곳에서 응답을 보내고, 해당 응답에서 redirect 정보를 가지고 새로운 요청으로 새로운 페이지를 오픈한다.
- spring 에서 활용
  - servlet이 client의 요청을 받고 여러 로직 처리를 거쳐 response를 생성한다. 이를 jsp에 forward 방식으로 jsp에 전달하여 화면을 구성하고 이를 client에 전달한다. 여기서 jsp가 forward 방식으로 request를 전달받기 때문에 같은 request 객체를 공유할 수 있다.
  - jsp에 보내기전에 servlet에서 `request.setAttribute("list", data)`를 거친 후 jsp에 묶어서 건넨다.

### JSP 페이지 라이프 사이클
1. jspInit
2. _jspService
3. jspDestroy