# 23.04.19

## SpringMVC : project
### SpringMVC 생성
### com.mvc.test => com.mvc.controller
### src.main.webapp.WEB-INF.spring
- 두 종류의 컨테이너 존재
- root-context.xml
  - `servlet-context.xml`보다 더 큰 범위의 컨테이너이다.
  - 생성한 project의 모든 곳에 접근 가능
  - 꼭 web과 관련된 것이 아닌 객체들이 만들어짐.
  - service, db, db pool 등등
- appServlet.servlet-context.xml
  - `root-context.xml`의 객체를 가져다 쓸 수 있음.(의존성 주입을 통해 사용, 역으로는 불가능) 
  - dispatcherServlet이 사용하는 컨테이너
  - web과 관련된 객체가 만들어져 있음.
  - controller를 담는 패키지를 component-scan하는 부분이 존재
  - InternalResourceViewResolver
    - .jsp만 다루는 ViewResolver
  - xmlnx의 우선 순위
### src.main
- .java 파일 위치하는 곳
### web.xml
- 톰캣이 시작되면 읽어가는 파일
- 톰캣 설정 파일
- 사용할 서블릿이 필수로 등록되어 있어야한다.
  - 이전에는 @WebServlet이라는 애너테이션으로 해결했음
- `<servlet>`태그와 `<servlet-mapping>`태그는 한 쌍이다.
  - servlet 태그 내부에 별칭을 붙이고, servlet-mapping에서 그 별칭을 가져다 씀
  - myServlet 구분해보는 연습
    - *.mvc를 받도록
### Context
- 하나의 프로젝트의 실행 환경
- 즉, 하나의 프로젝트를 실행시키면 생기며, Project 하나 당 Context 하나로 대응된다.
- Context의 이름은 Context root 값이다. 따라서, Context root가 중복되면 안되고 중복된다면 따로 실행시켜야한다.
### ContextLoaderListener
- Spring framework 존재하는 객체
- Context가 만들어지면 ContextLoaderListener가 인지하고 root-context.xml(parameter)을 읽어서 root-context container를 생성함
### `<Servlet>` 태그
- servlet을 만드는 태그
- servlet-context.xml을 파라미터로 제공
- 이곳에서 만들어지는 servlet은 웹과 관련된 servlet(보통 dispatcherServlet)으로, controller, viewResolver, interceptor와 같은 Web 관련 객체를 포함하고 있다.
### HomeController.java
- `@Controller`
  - component-scan에 걸리도록 명시하는 애너테이션
- `@RequestMapping`
  - HandlerMapping이 이녀석
  - 레거시 스프링에서는 HandlerMapping이 객체로 존재했지만, 현재는 애너테이션으로 대체됨.
  - value
    - url 값
    - url 값은 원칙적으로는 중복되면 안되지만 메서드가 다를 경우에는 가능
  - methode
    - 요청 방식(get)
- Handler method 
  - 파라미터
    - 핸들러 메서드에 넣어주는 값, 예를 들면 Model, HttpRequestSession(?)등을 주면 container가 알아서 빈 값을 만들어 준다.
  - 반환값
    - String
    - 논리적인 view의 이름(무조건)
    - 이 값을 기준으로 ViewResolver가 접두어, 접미어를 붙여서 물리적인 View 파일의 정보를 만들어줌 ㅋ.ㅋ
    - 해당 prefix, suffix 값은 servlet-context.xml에 적혀있다.
## SpringMVCBoard
- db 연동
- 설정 변경
  - project 우클릭 - Maven - Update Project - OK
### pom.xml
- 설정 변경
- dependency 추가
  - mysql driver 추가
### web.xml
- filter 추가
  - filter란, dispatchServlet 앞단에 위치하여 Client의 요청이 dispatchServlet에 전달되기전에 필터링하는 아이.
  - `<filter>` + `<filter-mapping>`이 한 쌍
- 요청 전 filtering
  - 전 처리
- 응답 전 filtering
  - 후 처리
- filter는 여러 개가 묶인 filterChain으로 존재할 수 있음
- 어떤 요청, 즉 특정 url만 filtering 하도록 설정할 수 있음.
### webapp == WebContent
### BoardServiceImpl.java
- @Service
### BoardDAOImpl.java
- @Repository
### root-context.xml
- context ns 추가
- component-scan
### BoardServiceImpl.java
- @Autowired
### BoardController.java
- @Autowired
- handler method 추가
### root-context.xml
- org.springframework.jdbc.datasource.SimpleDriverDataSource 추가
  - connection pool
    - connection 이 시간이 오래걸리기 때문에 미리 만들어놓는 connection
    - ~~DataSource인 애들은 connection poll 만드는 애임
    - 작업 후 반납 필수이다.
### BoardDAOImpl
- DataSource 생성 + @Autowired
  - import java.sql.Connection
  - 미리 생성된 Connection Pool에서 빌려오는 개념, 반납 필수