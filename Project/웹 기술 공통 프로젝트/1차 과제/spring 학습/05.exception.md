### Application에서 발생하는 Exception
- 클라이언트 요청 데이터에 대한 유효성 검증(Validation)에서 발생하는 예외
- 서비스 계층의 비즈니스 로직에서 던져지는 의도된 예외
- 웹 애플리케이션 실행 중에 발생하는 예외(RuntimeException)

# **1. Controller Validation**

### Exception 처리 방법
- @ExceptionHandler
- @RestControllerAdvice 

### @ExceptionHandler
- Controller 레벨에서 예외 처리를 하기 위해 사용하는 애너테이션
    ```java
    @ExceptionHandler
    public ResponseEntity handleException(Exception e) {// (1)
    // (2)
    final List<FieldError> fieldErrors = e.getBindingResult().getFieldErrors();

    return new ResponseEntity<>(fieldErrors, HttpStatus.BAD_REQUEST);
    }
    ```
    - (1) : Exception을 특정하여 핸들링 가능
    - (2) : .getBindingResult().getFieldErrors()을 통해서 발생한 에러 정보 수집
    - 위 코드는 에러에 관한 상세한 정보를 얻을 수 있음.
    - 특정 정보만을 받아 깔끔한 에러 메시지를 사용하고 싶다면 에러 코드에 대한 DTO 클래스를 만들어서 사용하면 된다. (mapper 연결은 되는지 잘 모름)

### @ExceptionHandler의 단점
- Controller 레벨에서 다루기 때문에 모든 Controller 클래스에 필요하고, 따라서 중복된 코드가 발생한다.

### @RestControllerAdvice를 사용한 예외 처리 공통화
- 여러 개의 Controller 클래스에서 @ExceptionHandler , @InitBinder 또는
@ModelAttribute 가 추가된 메서드를 공유해서 사용할 수 있다.
- @ExceptionHandler 관점에서는 즉, 하나의 클래스에서 작성된 예외 처리 메서드를 공통화하여 사용할 수 있다는 것.

### @RestControllerAdvice
- @ExceptionHandler 메서드들을 모아놓으면 된다.
- @RestControllerAdvice = @ControllerAdvice + @ResponseBody
  - 예외 처리 기능과 json 형식의 데이터를 자동 래핑할 수 있다.(ResponseEntity의 래핑 필요 없음)

# **2. Business Logic Throw Exception**

### 체크 예외(Checked Exception)와 언체크 예외(Unchecked Exception)
- 체크 예외
  - 발생한 예외를 붙잡아서 처리해야한다.
  - 롤백, 회피 등으로 처리
- 언체크 예외
  - 따로 예외를 처리할 필요가 없는 예외
  - 주로 잘못 작성된 코드로 발생하는 RuntimeException을 상속한 예외들이다.

### 의도적인 에외를 던지는 상황
- 로그인 한 유저의 정보가 DB에 없는 경우
- 로그인 패스워드가 검증에서 일치하지 않는 경우
- 송금을 하려했으나 잔고가 부족하여 프로세스가 종료되는 경우

### 예외 던지기/받기
- throw 키워드
  - 예외를 메서드 바깥으로 던지는 키워드
  - 메서드 바깥 : 메서드를 호출한 지점을 의미
- 던져지는 예외의 흐름
  1. Controller의 서비스 로직 호출
  2. 서비스 로직 내에서 예외 발생
  3. 예외 던지기
  4. 서비스 로직을 호출한 Controller에 예외 도착
  5. @RestControllerAdvice를 통한 예외 처리

### Custom Exception
- 서비스 로직에서 던져지는 예외가 상황은 다르나 같은 예외 클래스로 @RestControllerAdvice에 도착하는 경우가 대부분일 것. 때문에 발생한 예외와 던져진 의도가 불분명하다.
- 이를 극복하기 위해 Exception을 사용자 정의로 만들어 표현하는 것이 좋음